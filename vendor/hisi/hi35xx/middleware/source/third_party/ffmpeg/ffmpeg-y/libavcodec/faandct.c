#include "faandct.h"
#include "libavutil/internal.h"
#include "libavutil/libm.h"
typedef float FLOAT;

/* numbers generated by arbitrary precision arithmetic followed by truncation
to 36 fractional digits (enough for a 128-bit IEEE quad, see /usr/include/math.h
for this approach). Unfortunately, long double is not always available correctly,
e.g ppc has issues.
TODO: add L suffixes when ppc and toolchains sort out their stuff.
*/
#define B0 1.000000000000000000000000000000000000
#define B1 0.720959822006947913789091890943021267 // (cos(pi*1/16)sqrt(2))^-1
#define B2 0.765366864730179543456919968060797734 // (cos(pi*2/16)sqrt(2))^-1
#define B3 0.850430094767256448766702844371412325 // (cos(pi*3/16)sqrt(2))^-1
#define B4 1.000000000000000000000000000000000000 // (cos(pi*4/16)sqrt(2))^-1
#define B5 1.272758580572833938461007018281767032 // (cos(pi*5/16)sqrt(2))^-1
#define B6 1.847759065022573512256366378793576574 // (cos(pi*6/16)sqrt(2))^-1
#define B7 3.624509785411551372409941227504289587 // (cos(pi*7/16)sqrt(2))^-1

#define A1 M_SQRT1_2              // cos(pi*4/16)
#define A2 0.54119610014619698435 // cos(pi*6/16)sqrt(2)
#define A5 0.38268343236508977170 // cos(pi*6/16)
#define A4 1.30656296487637652774 // cos(pi*2/16)sqrt(2)

static const FLOAT postscale[64]={
B0*B0, B0*B1, B0*B2, B0*B3, B0*B4, B0*B5, B0*B6, B0*B7,
B1*B0, B1*B1, B1*B2, B1*B3, B1*B4, B1*B5, B1*B6, B1*B7,
B2*B0, B2*B1, B2*B2, B2*B3, B2*B4, B2*B5, B2*B6, B2*B7,
B3*B0, B3*B1, B3*B2, B3*B3, B3*B4, B3*B5, B3*B6, B3*B7,
B4*B0, B4*B1, B4*B2, B4*B3, B4*B4, B4*B5, B4*B6, B4*B7,
B5*B0, B5*B1, B5*B2, B5*B3, B5*B4, B5*B5, B5*B6, B5*B7,
B6*B0, B6*B1, B6*B2, B6*B3, B6*B4, B6*B5, B6*B6, B6*B7,
B7*B0, B7*B1, B7*B2, B7*B3, B7*B4, B7*B5, B7*B6, B7*B7,
};
